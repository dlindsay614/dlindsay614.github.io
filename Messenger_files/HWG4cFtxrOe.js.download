if (self.CavalryLogger) { CavalryLogger.start_js(["\/MUMB"]); }

__d('MessengerContextualActions.react',['cx','ContextualLayerUpdateOnScroll','LayerHideOnBlur','Link.react','React','ReactAbstractContextualDialog','ReactLayer'],(function a(b,c,d,e,f,g,h){'use strict';var i,j,k,l,m=c('React').PropTypes,n=c('ReactLayer').createClass(c('ReactAbstractContextualDialog').createSpec({displayName:'MessengerContextualActionsDialog',theme:{wrapperClassName:"_hw2",arrowDimensions:{offset:12,length:12}}}));i=babelHelpers.inherits(o,c('React').Component);j=i&&i.prototype;o.prototype.render=function(){var q=this.props,r=q.children,s=babelHelpers.objectWithoutProperties(q,['children']);return c('React').createElement(n,babelHelpers['extends']({alignment:'center',behaviors:{ContextualLayerUpdateOnScroll:c('ContextualLayerUpdateOnScroll'),LayerHideOnBlur:c('LayerHideOnBlur')}},s,{onToggle:this.props.onToggle}),c('React').createElement('ul',{className:"_hw3"},r));};function o(){i.apply(this,arguments);}o.propTypes={onToggle:m.func};o.Item=p;k=babelHelpers.inherits(p,c('React').Component);l=k&&k.prototype;p.prototype.render=function(){return c('React').createElement('li',{className:"_hw4"},c('React').createElement(c('Link.react'),{className:"_hw5",onClick:this.props.onClick},this.props.children));};function p(){k.apply(this,arguments);}p.propTypes={onClick:m.func};f.exports=o;}),null);
__d("XMessengerDotComSaveController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("\/save\/message\/",{});}),null);
__d('messengerDeleteMessageDialogReact',['fbt','bs_curry','reasonReact','MercuryConfig','messengerDialogReact','messengerDialogBodyReact'],(function a(b,c,d,e,f,g,h){'use strict';var i=+c('MercuryConfig').MessengerGlobalDeleteGK,j=c('reasonReact').statefulComponent("MessengerDeleteMessageDialogReact");function k(q){if(i!==0){if(q!==0){return h._("Delete Message?");}else return h._("Hide Message?");}else return h._("Delete Message");}function l(q){if(i!==0){if(q!==0){return h._("If you delete this message, no one in this conversation can see it anymore and it can't be undone.");}else return h._("If you hide your copy of this message, you can't get it back. The other person in the conversation may still be able to see it.");}else return h._("Are you sure you want to delete this message?");}function m(q){if(i!==0){if(q!==0){return h._("Delete");}else return h._("Hide");}else return h._("Delete");}function n(q,r,s,t,u){var v=function x(){c('bs_curry')._1(r,false);return c('bs_curry')._1(s,0);},w=j.slice();w[9]=function(x,y){return c('reasonReact').element(0,0,c('bs_curry')._8(c('messengerDialogReact').Dialog[0],0,r,0,0,0,0,0,[c('reasonReact').element(0,0,c('bs_curry')._3(c('messengerDialogReact').Header[0],0,0,[k(q)])),c('reasonReact').element(0,0,c('messengerDialogBodyReact').make(0,[l(q)])),c('reasonReact').element(0,0,c('bs_curry')._3(c('messengerDialogReact').Footer[0],0,0,[c('reasonReact').element(0,0,c('bs_curry')._2(c('messengerDialogReact').CancelButton[0],[t],[])),c('reasonReact').element(0,0,c('bs_curry').app(c('messengerDialogReact').Button[0],[0,[m(q)],0,["danger"],[v],[0],0,0,[]]))]))]));};return w;}function o(q){return n(+q.isFromViewer,q.onToggle,q.onDelete,q.onCancel,[]);}var p=c('reasonReact').createJsReactClass(o,j);g.globalDelete=i;g.component=j;g.renderDialogHeaderMsg=k;g.renderDialogBodyMsg=l;g.renderDialogButtonMsg=m;g.make=n;g.jsPropsToReason=o;g.comp=p;}),null);
__d('messengerSaveMessageDialogReact',['fbt','URI','bs_block','bs_curry','linkReact','reasonReact','messengerDialogReact','messengerDialogBodyReact','CollectionCurationReferrerTags','CollectionCurationReferrerParamNames'],(function a(b,c,d,e,f,g,h){'use strict';function i(o,p){return c('bs_block').__(1,[[[setTimeout(function(){return c('bs_curry')._1(o[1],false);},2000)],o[1]]]);}function j(o,p){var q=o[0];if(q){clearTimeout(q[0]);return 0;}else return 0;}var k=c('reasonReact').statefulComponent("MessengerSaveMessageDialogReact");function l(o,p){return [k[0],k[1],k[2],function(q,r){return [q[0],o];},i,k[5],j,k[7],k[8],function(q,r){var s={};s[c('CollectionCurationReferrerParamNames').CLICK_REF]=c('CollectionCurationReferrerTags').MESSENGER_DOT_COM_SAVE_CONFIRMATION;var t=new (c('URI'))("https://www.facebook.com/saved/").setQueryData(s);return c('reasonReact').element(0,0,c('bs_curry')._8(c('messengerDialogReact').Dialog[0],0,o,0,0,0,0,0,[c('reasonReact').element(0,0,c('bs_curry')._3(c('messengerDialogReact').Header[0],0,0,[h._("Saving to Facebook")])),c('reasonReact').element(0,0,c('messengerDialogBodyReact').make(0,[c('reasonReact').element(0,0,c('linkReact').make(0,0,0,0,[t],0,0,0,0,0,0,["_blank"],0,[h._("View your saved items")]))]))]));},function(){return [0,o];},k[11]];}function m(o){return l(o.onToggle,[]);}var n=c('reasonReact').createJsReactClass(m,k);g.didMount=i;g.willUnmount=j;g.component=k;g.make=l;g.jsPropsToReason=m;g.comp=n;}),null);
__d('MessengerMessageActions.react',['cx','fbt','FBClipboardLink.react','ImmutableObject','ReactLayeredComponentMixin_DEPRECATED','MercuryAttachmentType','MercuryConfig','MercuryMessageActions','MercuryMessageInfo','messengerDialogsRe','MessengerContextualActions.react','messengerDeleteMessageDialogReact','MessengerReactionsMenu.react','React','AsyncRequest','CollectionsDisplaySurface','CollectionCurationMechanisms','MessengerConfig','MessengerDotComSaveModule','messengerSaveMessageDialogReact','messengerURIUtilsRe','SaveMessageUtils','SavedStateActions','URLMatcher','XMessengerDotComSaveController'],(function a(b,c,d,e,f,g,h,i){'use strict';var j=c('messengerDeleteMessageDialogReact').comp,k=c('messengerSaveMessageDialogReact').comp,l=c('MessengerContextualActions.react').Item,m=c('React').PropTypes,n=c('React').createClass({displayName:'MessengerMessageActions',mixins:[c('ReactLayeredComponentMixin_DEPRECATED')],propTypes:{isActive:m.bool,isDeletable:m.bool,isFromViewer:m.bool,includeReactions:m.bool,message:m.instanceOf(c('ImmutableObject')).isRequired},getDefaultProps:function o(){return {isDeletable:true};},getInitialState:function o(){return {shown:false};},render:function o(){return this.props.isActive?c('React').createElement('span',{className:"_2rvp",ref:'actions',onClick:this._toggleShown},this.renderMenu()):null;},renderMenu:function o(){if(!this.state.open)return null;return c('React').createElement(c('MessengerReactionsMenu.react'),{entryPoint:'dot_menu',message:this.props.message,onHide:this._hidePopover,refProp:function(){return this.refs.actions;}.bind(this)});},_openPopover:function o(){this.setState({open:true,shown:false});},_hidePopover:function o(){this.setState({open:false});},renderLayers:function o(){if(!this.state.shown)return {};var p=[];p.push(c('React').createElement(l,{key:'delete',onClick:this._handleDelete},this._renderActionItemMsg()));if(this._canSaveMessage())p.push(c('React').createElement(l,{key:'save',onClick:this._handleSave},this._renderSaveItemMsg()));if(c('MessengerConfig').ShowMessageLinks)p.push(c('React').createElement(l,{key:'react',onClick:this._handleLink},this._renderLinkItemMsg()));if(this.props.includeReactions)p.push(c('React').createElement(l,{key:'perma-link',onClick:this._openPopover},this._renderReactionMsg()));return {contextualDialog:c('React').createElement(c('MessengerContextualActions.react'),{context:this.refs.actions,onToggle:this._handleActionsToggle,shown:this.props.isActive},this._renderRetry(),p)};},_toggleShown:function o(){this.setState({shown:!this.state.shown},function(){return this.props.onShowMenu(this.state.shown);}.bind(this));},_renderActionItemMsg:function o(){if(!this.props.isFromViewer&&c('MercuryConfig').MessengerGlobalDeleteGK)return i._("Hide");return i._("Delete");},_renderSaveItemMsg:function o(){return i._("Save to Facebook");},_renderReactionMsg:function o(){return i._("React");},_renderLinkItemMsg:function o(){var p=c('messengerURIUtilsRe').getURIForMessageID(this.props.message.message_id).getQualifiedURIBase().toString(),q=i._("Copy Link");return c('React').createElement(c('FBClipboardLink.react'),{suppress:true,tooltip:'',value:p},q);},_renderRetry:function o(){if(!c('MercuryMessageInfo').hasError(this.props.message))return null;return c('React').createElement(l,{onClick:this._handleRetry},i._("Try Again"));},_handleActionsToggle:function o(p){!p&&this._handleDeselect();},_handleDeselect:function o(){this.setState({shown:false},function(){return this.props.onShowMenu(this.state.shown);}.bind(this));},_handleDelete:function o(){var p=this.props.message;c('messengerDialogsRe').showDialog(function(){return c('React').createElement(j,{onDelete:function q(){c('MercuryMessageActions').get()['delete'](p.thread_id,[p.message_id]);},onToggle:this._handleDialogToggle,onCancel:this._handleDeselect,isFromViewer:this.props.isFromViewer});}.bind(this));},_canSaveMessage:function o(){var p=this.props.message;if(c('MessengerDotComSaveModule').enabled_messenger_save&&this._isSavableMessageAttachment())return true;if(c('MessengerDotComSaveModule').enabled_messenger_save&&p.attachments&&p.attachments.length>0&&p.attachments[0].share&&p.attachments[0].share.media&&p.attachments[0].share.media.playable)return true;if(c('MessengerDotComSaveModule').enabled_messenger_save){var q=c('URLMatcher').match(p.body);if(q!=null&&q.length>0)return true;}return false;},_handleLink:function o(){this._handleActionsToggle(false);},_isSavableMessageAttachment:function o(){var p=this.props.message.attachments;if(!p||p.length===0)return false;for(var q=0;q<p.length;q++){var r=p[q],s=false;if(r.share&&r.share.style_list){var t=r.share.style_list;s=c('SaveMessageUtils').isSavableMessageAttachment(t);}else s=r.attach_type===c('MercuryAttachmentType').VIDEO;if(!s)return false;}return true;},_handleSave:function o(){var p=this.props.message,q=c('CollectionsDisplaySurface').MESSENGER_DOT_COM_MESSAGE,r=c('CollectionCurationMechanisms').RIGHT_CLICK;new (c('AsyncRequest'))().setURI(c('XMessengerDotComSaveController').getURIBuilder().getURI()).setData({action:c('SavedStateActions').SAVE,surface:q,mechanism:r,message_id:p.message_id}).send();c('messengerDialogsRe').showDialog(function(){return c('React').createElement(k,{onToggle:this._handleDialogToggle});}.bind(this));this._handleActionsToggle(false);},_handleDialogToggle:function o(p){if(!p)c('messengerDialogsRe').removeDialog();},_handleRetry:function o(){this._handleDeselect();c('MercuryMessageActions').get().resend(this.props.message);}});f.exports=n;}),null);