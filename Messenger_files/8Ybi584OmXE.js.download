if (self.CavalryLogger) { CavalryLogger.start_js(["aPh7d"]); }

__d('DOMP2PTrigger',['cx','MessengerEnvironment','JSXDOM','P2PAmountUtils','P2PTriggersUtils','TransformTextToDOMMixin'],(function a(b,c,d,e,f,g,h){var i={MAX_ITEMS:40,match:function j(k){var l=c('P2PTriggersUtils').getMatches(k);if(!l||!l.length)return false;var m=l[0];if(!c('P2PAmountUtils').isValidSendAmount(m))return false;var n=l.index;return {startIndex:n,endIndex:n+m.length,element:this._element(m)};},_element:function j(k){return c('JSXDOM').a({href:"#",className:"_35i0"+(!c('MessengerEnvironment').messengerui?' '+"_4g4e":''),"data-p2p-trigger":k},k);}};f.exports=Object.assign(i,c('TransformTextToDOMMixin'));}),null);
__d('p2pTriggerJSXDOMToString',['DOMEmoji','DOMEmote','DOMP2PTrigger','JSXDOM','transformTextToDOM'],(function a(b,c,d,e,f,g){var h=function i(j,k,l,m,n,o){var p=[];if(m)p.push(c('DOMP2PTrigger'));if(k)n?p.push(c('DOMEmoji').params({isSupportedEmoji:n})):p.push(c('DOMEmoji'));if(l)o?p.push(c('DOMEmote').params({getMessengerEmote:o})):p.push(c('DOMEmote'));return c('JSXDOM').span(null,c('transformTextToDOM')(j,p)).innerHTML;};f.exports=h;}),null);
__d('P2PTriggers.react',['DOM','Event','MercuryIDs','P2PActions','P2PLogger','P2PPaymentLoggerEvent','P2PPaymentLoggerEventFlow','P2PUserEligibilityStore','StoreAndPropBasedStateMixin','React','ReactDOM','nullthrows','p2pTriggerJSXDOMToString'],(function a(b,c,d,e,f,g){'use strict';var h=c('React').PropTypes,i=c('React').createClass({displayName:'P2PTriggers',mixins:[c('StoreAndPropBasedStateMixin')(c('P2PUserEligibilityStore'))],propTypes:{getMessengerEmote:h.func,isSupportedEmoji:h.func,renderEmoji:h.bool,renderEmoticons:h.bool,text:h.string.isRequired,threadID:h.string.isRequired},getInitialState:function j(){return {amount:''};},statics:{calculateState:function j(k){var l=c('MercuryIDs').isGroupChat(k.threadID)||c('P2PUserEligibilityStore').getEligibilityByThreadID(k.threadID);return {isThreadEligible:l,otherUserID:c('MercuryIDs').getUserIDFromThreadID(k.threadID)};}},_clickListeners:null,componentDidMount:function j(){this._clickListeners=[];this.bindClickListeners();},componentWillUnmount:function j(){this.unbindClickListeners();},log:function j(k,l){c('P2PLogger').log(k,babelHelpers['extends']({www_event_flow:c('P2PPaymentLoggerEventFlow').UI_FLOW_P2P_SEND,object_id:this.state.otherUserID},l));},bindClickListeners:function j(){var k=c('nullthrows')(this._clickListeners);if(!k.length){var l=c('DOM').scry(c('ReactDOM').findDOMNode(this),'[data-p2p-trigger]');for(var m=0,n=l.length;m<n;m++)k.push(c('Event').listen(l[m],'click',this.handleTriggerClick));}},unbindClickListeners:function j(){var k=void 0;if(this._clickListeners){for(var l=0,m=this._clickListeners.length;l<m;l++){k=this._clickListeners[l];if(k)k.remove();}this._clickListeners=[];}},componentDidUpdate:function j(k,l){if(!l.isThreadEligible&&this.state.isThreadEligible)this.bindClickListeners();},getAmountFromTriggerClickEvent:function j(k){var l=k.target.getAttribute('data-p2p-trigger')||'';return l.replace(/[^0-9\.]+/g,'');},handleTriggerClick:function j(k){k.preventDefault();var l=this.getAmountFromTriggerClickEvent(k);this.setState({amount:l});this.openSendView();this.log(c('P2PPaymentLoggerEvent').UI_ACTN_INITIATE_SEND_TRIGGER,{raw_amount:this.state.amount,currency:'USD'});},openSendView:function j(){c('P2PActions').chatSendViewOpened({threadID:this.props.threadID,amount:this.state.amount});},render:function j(){var k=c('p2pTriggerJSXDOMToString')(this.props.text,this.props.renderEmoji,this.props.renderEmoticons,this.state.isThreadEligible,this.props.isSupportedEmoji,this.props.getMessengerEmote);return c('React').createElement('span',{dangerouslySetInnerHTML:{__html:k}});}});f.exports=i;}),null);
__d('TextWithEntitiesAndP2P.react',['BaseTextWithEntities.react','Link.react','P2PTriggers.react','React'],(function a(b,c,d,e,f,g){'use strict';var h=c('React').createClass({displayName:'TextWithEntitiesAndP2P',_renderText:function i(j){return c('React').createElement(c('P2PTriggers.react'),{getMessengerEmote:this.props.getMessengerEmote,isSupportedEmoji:this.props.isSupportedEmoji,renderEmoticons:this.props.renderEmoticons,renderEmoji:this.props.renderEmoji,text:j,threadID:this.props.threadID});},_renderRange:function i(j,k){if(this.props.interpolator){return this.props.interpolator(j,k);}else return c('React').createElement(c('Link.react'),{href:k.entity},j);},render:function i(){return c('React').createElement(c('BaseTextWithEntities.react'),babelHelpers['extends']({},this.props,{textRenderer:this._renderText,rangeRenderer:this._renderRange,ranges:this.props.ranges,imageRanges:this.props.imageRanges,aggregatedRanges:this.props.aggregatedRanges,text:this.props.text}));}});f.exports=h;}),null);